# 05: UI変更時のE2Eと成果物（スクショ/動画/トレース）

本章は、UI変更がある場合にE2E（可能なら）を追加・実行し、成果物をPRに添付する運用を定義します。

## 目的
- UIの回帰をE2Eで検知し、レビュー効率を高める
- レビュー時にスクリーンショット等で差分を視覚化

## 完了条件（DoD）
- 対象操作のE2E（Playwright）が追加/更新され、ローカルで緑
- スクショ/動画/トレースを取得し、PRに添付（CI実行時はArtifactsで参照）

## 手順
1) E2Eシナリオの定義
- 主要操作に限定（過剰網羅を避ける）
- データはseed/fixtureで安定化、アニメーション無効化、auto-wait活用

2) 実行と成果物
- ローカル: `pnpm test:e2e`（HTMLレポート/スクショ/動画/トレース）
- PR添付: Before/After のスクショ、必要に応じてGIF/動画
- CI: 失敗時はArtifactsで成果物を確認

3) MCP（開発限定, 任意）
- ローカル開発では Playwright MCP を用いて成果物の収集/参照を補助可能
- CI/公開/本番ではMCPは使用しない（設計方針）

## チェックリスト
- [ ] 主要なUI操作のE2Eを追加/更新
- [ ] ローカルで緑、成果物をPRに添付
- [ ] MCP（任意）を使う場合も、MCPなしで完結可能

## よくある落とし穴
- E2Eの過剰網羅 → 不安定化/長時間化
- 非決定的な待機/タイミング → auto-wait/安定化設定を活用

## 関連リンク
- 開発者ガイド: 7.3.2 UI変更時の成果物添付（`docs/04_developer_guide.md`）
- テスト戦略: `docs/05_testing_strategy.md`
- 開発向けMCP: `docs/10_dev_mcp.md`
