# 開発向け MCP 環境ガイド（ローカル限定）

本書は、Claude Code を主とする開発フローにおいて、MCP（Model Context Protocol）対応のツールをローカルで併用する方針と設定観点をまとめる。運用/公開/本番環境では MCP は使用しない。

## 1. 目的と対象
- 目的: 開発中の検証効率（E2E成果物の収集/参照、知識連携等）を高める
- 対象: ローカル開発環境（個人マシン、もしくは開発用VM）

## 2. 採用ツール（例）
- Playwright MCP: E2Eテスト結果（スクショ/動画/トレース）の収集/参照を補助
- Serena MCP: ドキュメント/ナレッジ連携やタスク支援

注: MCP サーバのインストール/設定は Claude Code 側で実施する。本リポジトリではエンドポイントなどの参照のみ。

## 3. 運用ポリシー
- 範囲制限: MCP は開発環境のみで使用。CI/公開/本番では無効
- セキュリティ: APIキーやトークンは `.env.local` 等で個人保持し、リポジトリへコミットしない
- 可用性: MCP 非連携でも全テスト/開発フローが自律的に完結する

## 4. 連携方法（概念）
- E2E（Playwright）
  - デフォルト: 標準Reporterで HTML/スクショ/動画/トレースを出力
  - MCP連携: Reporterまたは後処理で成果物を MCP に通知/同期（任意）
- ナレッジ/作業補助（Serena）
  - ドキュメントの参照/要約/リンク整理などを開発者のローカル環境で支援

## 5. 環境変数（例）
- `E2E_USE_MCP=true|false`（開発では任意でtrue、CI/本番は未設定/false）
- `MCP_PLAYWRIGHT_ENDPOINT=<http://localhost:xxxx>`
- `MCP_SERENA_ENDPOINT=<http://localhost:xxxx>`

注: 具体的なポート/トークン/追加項目は MCP サーバの実構成に合わせて Claude Code 側で設定。

## 6. 故障時のフォールバック
- MCP エンドポイントに接続できない場合、テスト/ビルド/開発フローは通常どおり進行（MCP 機能は自動無効）
- E2E成果物は従来どおりローカル出力/CI Artifacts で閲覧可能

## 7. 変更履歴
- 2025-08-12: 初版（開発限定で MCP を採用、Playwright/Serena を想定）
